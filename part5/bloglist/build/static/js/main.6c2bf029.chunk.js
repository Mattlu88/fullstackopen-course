(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{16:function(e,t,n){e.exports=n(42)},23:function(e,t,n){},24:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(14),o=n.n(l),c=n(2),u=function(e){var t=e.username,n=e.password,a=e.handleLogin;return console.log("rending loginform"),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:a},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username"},"username: "),r.a.createElement("input",Object.assign({id:"username",name:"username"},t,{required:!0,autoFocus:!0}))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"password: "),r.a.createElement("input",Object.assign({id:"password",name:"password"},n,{required:!0}))),r.a.createElement("button",null,"login")))},i=n(4),s=n.n(i),m=n(15),d=(n(23),function(e){var t=e.blog,n=e.blogService,l=e.currUser,o=e.setMessage,u=Object(a.useState)(!1),i=Object(c.a)(u,2),d=i[0],f=i[1],g=Object(a.useState)(t),p=Object(c.a)(g,2),h=p[0],v=p[1];return r.a.createElement("div",{className:"blogContainer"},r.a.createElement("div",{className:"blogHeader",onClick:function(){f(!d)}},h.title," ",h.author),d&&r.a.createElement("div",null,r.a.createElement("p",null,h.url),r.a.createElement("p",null,h.likes," likes",r.a.createElement("button",{onClick:function(){var e;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e=Object(m.a)({},h,{likes:h.likes+1}),v(e),a.next=5,s.a.awrap(n.update(h.id,e));case 5:a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),v(t),o({type:"error",text:"Failed to add likes"});case 11:case"end":return a.stop()}}),null,null,[[0,7]])}},"like")),r.a.createElement("p",null,"added by ",h.user.username),l.id===h.user.id&&r.a.createElement("button",{onClick:function(){return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("remove blog ".concat(h.title," by ").concat(h.author))){e.next=10;break}return e.prev=1,e.next=4,s.a.awrap(n.remove(h.id));case 4:o({type:"info",text:"".concat(h.title," has been deleted")}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),o({type:"error",text:e.t0.response.data.error});case 10:case"end":return e.stop()}}),null,null,[[1,7]])}},"remove")))}),f=function(e){var t=e.newBlog,n=e.handleCreateNewBlog;return r.a.createElement("div",null,r.a.createElement("h2",null,"Create new blog"),r.a.createElement("form",{onSubmit:n},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"title"},"title:"),r.a.createElement("input",Object.assign({id:"title",name:"title"},t.title.input))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"author"},"author:"),r.a.createElement("input",Object.assign({id:"author",name:"author"},t.author.input))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"url"},"url:"),r.a.createElement("input",Object.assign({id:"url",name:"url"},t.url.input))),r.a.createElement("div",null,r.a.createElement("button",null,"create"))))},g=function(e){var t=e.showBlogForm,n=e.handleOnClick;return r.a.createElement("div",null,t?r.a.createElement("div",null,e.children,r.a.createElement("button",{onClick:n},"cancel")):r.a.createElement("div",null,r.a.createElement("button",{onClick:n},"new note")))},p=(n(24),function(e){var t=e.message;if(0===t.text.length)return r.a.createElement("div",null);var n="noti";return n="info"===t.type?n.concat(" noti-info"):n.concat(" noti-error"),r.a.createElement("div",{className:n},r.a.createElement("p",null,t.text))}),h=n(3),v=n.n(h),b=null,E=function(e){b="Bearer ".concat(e)},w=function(){return b},k=function(e){var t=Object(a.useState)(""),n=Object(c.a)(t,2),r=n[0],l=n[1];return{input:{type:e,value:r,onChange:function(e){l(e.target.value)}},reset:function(e){l(e||"")}}},O=function(e){return v.a.post("/api/login",e).then((function(e){return e.data}))},j=function(e){var t=e.blogs,n=e.blogService,a=e.currUser,l=e.setMessage;return t.concat().sort((function(e,t){return t.likes-e.likes})).map((function(e){return r.a.createElement(d,{key:e.id,blog:e,blogService:n,currUser:a,setMessage:l})}))},x=function(e){var t=e.loggedUser,n=e.handleLogout;return r.a.createElement("div",null,r.a.createElement("p",null,t.username," logged in",r.a.createElement("button",{onClick:n},"logout")))};var y=function(){var e=k("text"),t=k("password"),n=function(e){var t=Object(a.useState)([]),n=Object(c.a)(t,2),r=n[0],l=n[1];return[r,{getAll:function(){v.a.get(e,{headers:{Authorization:w()}}).then((function(e){return l(e.data)}))},create:function(t){v.a.post(e,t,{headers:{Authorization:w()}}).then((function(e){return l(r.concat(e.data))}))},update:function(t,n){v.a.put("".concat(e,"/").concat(t),n,{headers:{Authorization:w()}}).then((function(e){return l(r.filter((function(t){return t.id!==e.data.id})).concat(e.data))}))},remove:function(t){v.a.delete("".concat(e,"/").concat(t),{headers:{Authorization:w()}}).then((function(){return l(r.filter((function(e){return e.id!==t})))}))}}]}("/api/blogs"),l=Object(c.a)(n,2),o=l[0],i=l[1],s=Object(a.useState)(),m=Object(c.a)(s,2),d=m[0],h=m[1],b=Object(a.useState)(!1),y=Object(c.a)(b,2),S=y[0],C=y[1],B={type:"",text:""},F=Object(a.useState)(B),A=Object(c.a)(F,2),N=A[0],U=A[1],z={title:k("text"),author:k("text"),url:k("url"),reset:function(){this.title.reset(),this.author.reset(),this.url.reset()}};Object(a.useEffect)((function(){I()}),[]);var I=function(){var e=window.localStorage.getItem("myBlogToken");if(e){var t=JSON.parse(e);E(t.token),i.getAll(),h(t)}};return r.a.createElement("div",null,d?r.a.createElement("div",null,r.a.createElement("h1",null,"Blogs"),r.a.createElement(p,{message:N}),r.a.createElement(x,{loggedUser:d,handleLogout:function(){window.localStorage.removeItem("myBlogToken"),h(""),e.reset(),t.reset(),C(!1),U(B)}}),r.a.createElement(g,{showBlogForm:S,handleOnClick:function(){C(!S)}},r.a.createElement(f,{newBlog:z,handleCreateNewBlog:function(e){e.preventDefault();var t={title:z.title.input.value,author:z.author.input.value,url:z.url.input.value};i.create(t),U({type:"info",text:"a new blog ".concat(t.title," by ").concat(t.author," added")}),z.reset()}})),r.a.createElement(j,{blogs:o,blogService:i,currUser:d,setMessage:U})):r.a.createElement("div",null,r.a.createElement("h1",null,"log in to application"),r.a.createElement(p,{message:N}),r.a.createElement(u,{username:e.input,password:t.input,handleLogin:function(n){n.preventDefault(),U(B),O({username:e.input.value,password:t.input.value}).then((function(e){return E(e.token),e})).then((function(e){return h(e),e})).then((function(e){return i.getAll(),e})).then((function(e){window.localStorage.setItem("myBlogToken",JSON.stringify(e))})).catch((function(n){console.log(n),U({type:"error",text:"wrong username or password"}),h(""),e.reset(),t.reset()}))},message:N})))};o.a.render(r.a.createElement(y,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.6c2bf029.chunk.js.map